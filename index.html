<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Binary Screensaver Overnight-Safe</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="screen"></canvas>
<script>
const canvas = document.getElementById('screen');
const ctx = canvas.getContext('2d');

let width, height;
let fontSize = 16;
let lines;
const columns = 200;      // fixed number of characters per line
let buffer = [];           // declare buffer BEFORE calling resize/initBuffer()

// Initialize screen buffer
function initBuffer() {
  buffer = Array(lines).fill('').map(() => Array(columns).fill(' '));
}

// Resize canvas and recalculate lines
function resize() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
  ctx.font = `${fontSize}px monospace`;
  ctx.fillStyle = '#00ff00';
  ctx.textBaseline = 'top';
  lines = Math.ceil(height / fontSize);
  initBuffer();
}

window.addEventListener('resize', resize);
resize();

// Draw the buffer on canvas
function draw() {
  ctx.clearRect(0, 0, width, height);
  for (let y = 0; y < lines; y++) {
    const xOffset = Math.floor(Math.random() * 3); // slight shift for burn-in prevention
    ctx.fillText(buffer[y].join(''), xOffset, y * fontSize);
  }
}

// Shift buffer upward and add new line at bottom
function shiftBuffer() {
  buffer.shift();
  const newLine = Array(columns).fill(0).map(() => Math.random() < 0.5 ? '0' : '1');
  buffer.push(newLine);
}

// Main loop with throttled updates (~10 FPS, 6Ã— slower than 60 FPS)
let lastUpdate = 0;
const interval = 1000 / 10; // 10 FPS

function loop(timestamp) {
  if (timestamp - lastUpdate > interval) {
    shiftBuffer();
    draw();
    lastUpdate = timestamp;
  }
  requestAnimationFrame(loop);
}

// Start animation loop
requestAnimationFrame(loop);
</script>
</body>
</html>
